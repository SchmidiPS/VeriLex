<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VeriLex – Offene-Posten-Übersicht</title>
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#1f3c88" />
    <link rel="stylesheet" href="assets/css/styles.css" />
  </head>
  <body>
    <header class="app-header">
      <div class="app-header__toolbar">
        <a class="btn btn-secondary app-header__back" href="index.html">Zur Übersicht</a>
        <div class="app-header__actions">
          <a class="btn btn-secondary" href="performance-overview.html">Leistungsübersicht</a>
          <a class="btn btn-secondary" href="invoice-wizard.html">Rechnungs-Wizard</a>
        </div>
      </div>
      <h1>Offene-Posten-Übersicht</h1>
      <p class="app-subtitle">
        Behalten Sie unbezahlte Rechnungen, offene Beträge und bereits beglichene Vorgänge transparent im Blick.
      </p>
    </header>

    <main class="app-main receivables-main" aria-live="polite">
      <section
        class="receivables-board"
        aria-labelledby="receivables-title"
        data-visible-for="partner,accounting"
      >
        <header class="receivables-board__header">
          <div>
            <h2 id="receivables-title">Statusüberblick Ihrer Forderungen</h2>
            <p class="receivables-board__description">
              Die nachfolgende Liste greift auf die zentralen Rechnungs- und Leistungsdaten des Stores zu und zeigt, welche
              Rechnungen offen, überfällig oder bereits bezahlt sind. Nutzen Sie die Filter, um sich auf relevante Fälle zu
              konzentrieren und Änderungen aus anderen Modulen direkt zu sehen.
            </p>
          </div>
          <dl class="receivables-summary" aria-label="Summen nach Status">
            <div class="receivables-summary__item receivables-summary__item--open">
              <dt>Offen</dt>
              <dd>
                <span id="receivables-summary-open-count" class="receivables-summary__count">0</span>
                <span class="receivables-summary__separator" aria-hidden="true">·</span>
                <span id="receivables-summary-open-amount" class="receivables-summary__amount">0,00&nbsp;€</span>
              </dd>
            </div>
            <div class="receivables-summary__item receivables-summary__item--overdue">
              <dt>Überfällig</dt>
              <dd>
                <span id="receivables-summary-overdue-count" class="receivables-summary__count">0</span>
                <span class="receivables-summary__separator" aria-hidden="true">·</span>
                <span id="receivables-summary-overdue-amount" class="receivables-summary__amount">0,00&nbsp;€</span>
              </dd>
            </div>
            <div class="receivables-summary__item receivables-summary__item--paid">
              <dt>Bezahlt</dt>
              <dd>
                <span id="receivables-summary-paid-count" class="receivables-summary__count">0</span>
                <span class="receivables-summary__separator" aria-hidden="true">·</span>
                <span id="receivables-summary-paid-amount" class="receivables-summary__amount">0,00&nbsp;€</span>
              </dd>
            </div>
          </dl>
        </header>

        <p id="receivables-outstanding-total" class="receivables-highlight" role="status">
          Summe offener und überfälliger Posten: 0,00&nbsp;€
        </p>

        <form class="receivables-filters" aria-label="Rechnungen filtern" novalidate>
          <div class="receivables-filter">
            <label class="receivables-filter__label" for="receivables-search">Schnellsuche</label>
            <input
              type="search"
              id="receivables-search"
              name="search"
              placeholder="Nach Rechnungsnummer, Mandant oder Akte suchen"
              autocomplete="off"
              spellcheck="false"
              aria-describedby="receivables-table-summary"
            />
          </div>
          <div class="receivables-filter">
            <label class="receivables-filter__label" for="receivables-status-filter">Status</label>
            <select id="receivables-status-filter" name="status">
              <option value="all">Alle Status</option>
              <option value="open">Offen</option>
              <option value="overdue">Überfällig</option>
              <option value="paid">Bezahlt</option>
            </select>
          </div>
          <div class="receivables-filter receivables-filter--checkbox">
            <input type="checkbox" id="receivables-outstanding-only" name="outstandingOnly" />
            <label for="receivables-outstanding-only">Nur offene &amp; überfällige anzeigen</label>
          </div>
        </form>

        <p id="receivables-table-summary" class="receivables-table-summary" role="status">
          0 Rechnungen gefunden.
        </p>

        <div class="table-wrapper" role="region" aria-labelledby="receivables-title" aria-live="polite">
          <table class="receivables-table">
            <thead>
              <tr>
                <th scope="col">Rechnung</th>
                <th scope="col">Mandant &amp; Akte</th>
                <th scope="col">Fälligkeit</th>
                <th scope="col">Betrag</th>
                <th scope="col">Status</th>
              </tr>
            </thead>
            <tbody id="receivables-table-body"></tbody>
          </table>
      </div>
      <p id="receivables-empty-state" class="receivables-empty-state" hidden>
        Für die aktuelle Filterauswahl sind keine Rechnungen vorhanden.
      </p>
    </section>
    </main>

    <section class="role-access-message" data-visible-for="associate,assistant">
      <h2>Offene Posten nur für Abrechnungsteams</h2>
      <p>
        Diese Übersicht unterstützt Partner:innen und Buchhaltung bei der Liquiditätsplanung. Wechseln
        Sie oben die Rolle, um den Zugriff zu erhalten.
      </p>
    </section>

    <div
      id="global-error-overlay"
      class="error-overlay"
      role="alertdialog"
      aria-modal="true"
      aria-labelledby="error-overlay-title"
      aria-describedby="error-overlay-message"
      hidden
    >
      <div class="error-overlay__content" role="document">
        <header class="error-overlay__header">
          <h2 id="error-overlay-title">Ein unerwarteter Fehler ist aufgetreten</h2>
          <button
            type="button"
            class="error-overlay__close"
            aria-label="Fehlermeldung schließen"
            data-error-action="dismiss"
          >
            ×
          </button>
        </header>
        <div id="error-overlay-message" class="error-overlay__message"></div>
        <details class="error-overlay__details">
          <summary>Technische Details einblenden</summary>
          <pre id="error-overlay-details"></pre>
        </details>
        <footer class="error-overlay__footer">
          <button type="button" class="btn" data-error-action="reload">Seite neu laden</button>
          <button type="button" class="btn btn-secondary" data-error-action="dismiss">Schließen</button>
        </footer>
      </div>
    </div>

    <script src="assets/js/app.js" type="module"></script>
    <script src="assets/js/open-items.js" type="module"></script>
  </body>
</html>
