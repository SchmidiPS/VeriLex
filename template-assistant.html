<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VeriLex – Vorlagen-Assistent</title>
    <link rel="stylesheet" href="assets/css/styles.css" />
  </head>
  <body>
    <header class="app-header">
      <h1>VeriLex Demo</h1>
      <p class="app-subtitle">Vorlagen-Assistent für Textbausteine</p>
    </header>

    <main class="app-main template-assistant-main" aria-live="polite">
      <nav class="case-breadcrumb" aria-label="Brotkrumen">
        <a class="case-breadcrumb__link" href="index.html">&larr; Zur Startseite</a>
      </nav>

      <section
        class="app-card template-assistant"
        aria-labelledby="template-assistant-title"
        data-visible-for="partner,associate,assistant"
      >
        <header class="template-assistant__header">
          <div>
            <h2 id="template-assistant-title">Textbausteine auswählen &amp; anpassen</h2>
            <p class="template-assistant__description">
              Wählen Sie links eine Vorlage, passen Sie Platzhaltertexte an und fügen Sie den finalen Text direkt in Ihren Dokumententwurf ein.
            </p>
          </div>
          <form class="template-search" role="search" aria-label="Vorlagen durchsuchen">
            <label class="visually-hidden" for="template-search-input">Vorlagen durchsuchen</label>
            <input
              id="template-search-input"
              type="search"
              name="query"
              placeholder="Nach Titel, Kategorie oder Tags suchen"
              autocomplete="off"
              spellcheck="false"
              aria-describedby="template-search-hint"
            />
            <p id="template-search-hint" class="template-search__hint">Eingabe sofort, keine Enter-Taste nötig.</p>
          </form>
        </header>

        <div class="template-assistant__layout">
          <section class="template-list-section" aria-labelledby="template-list-title">
            <div class="template-list-section__header">
              <h3 id="template-list-title">Verfügbare Vorlagen</h3>
              <p class="template-list-section__summary" id="template-list-summary" role="status" aria-live="polite"></p>
            </div>
            <ul id="template-list" class="template-list" role="list"></ul>
            <p id="template-empty-state" class="template-empty-state" hidden>
              Keine Vorlage erfüllt aktuell die Suchkriterien. Bitte passen Sie den Suchbegriff an.
            </p>
          </section>

          <section class="template-editor-section" aria-labelledby="template-editor-title">
            <header class="template-editor__header">
              <h3 id="template-editor-title">Vorlage bearbeiten</h3>
              <p id="template-editor-description">
                Wählen Sie eine Vorlage aus der Liste, um Platzhalter auszufüllen. Die Vorschau aktualisiert sich automatisch.
              </p>
            </header>
            <article id="template-details" class="template-details" hidden>
              <h4 id="template-name" class="template-details__name"></h4>
              <p id="template-summary" class="template-details__summary"></p>
              <dl class="template-details__meta">
                <div>
                  <dt>Kategorie</dt>
                  <dd id="template-category"></dd>
                </div>
                <div>
                  <dt>Tags</dt>
                  <dd id="template-tags"></dd>
                </div>
              </dl>
            </article>
            <p id="template-placeholder-hint" class="template-placeholder-hint">
              Tipp: Nutzen Sie die Suche, um schnell passende Textbausteine für wiederkehrende Aufgaben zu finden.
            </p>
            <form id="template-form" class="template-form" novalidate hidden>
              <div id="template-fields" class="template-form__fields"></div>
              <div class="template-preview">
                <label for="template-preview-output" class="template-preview__label">Vorschau des Textbausteins</label>
                <textarea
                  id="template-preview-output"
                  class="template-preview__output"
                  rows="10"
                  readonly
                  aria-describedby="template-preview-meta"
                ></textarea>
                <p id="template-preview-meta" class="template-preview__meta"></p>
              </div>
              <div class="template-form__actions">
                <button type="button" id="template-insert" class="btn btn-primary">In Dokument einfügen</button>
                <button type="button" id="template-copy" class="btn btn-secondary">In Zwischenablage kopieren</button>
              </div>
              <p id="template-feedback" class="template-feedback" role="status" aria-live="polite"></p>
            </form>
          </section>
        </div>
      </section>

      <section
        class="app-card document-draft"
        aria-labelledby="document-draft-title"
        data-visible-for="partner,associate,assistant"
      >
        <header class="document-draft__header">
          <div>
            <h2 id="document-draft-title">Dokumententwurf</h2>
            <p class="document-draft__description">
              Hier können Sie die eingefügten Textbausteine weiterbearbeiten oder kombinieren.
            </p>
          </div>
          <button type="button" id="document-draft-clear" class="btn btn-secondary">Entwurf leeren</button>
        </header>
        <label class="visually-hidden" for="document-draft-input">Dokumententwurf bearbeiten</label>
        <textarea
          id="document-draft-input"
          class="document-draft__textarea"
          rows="12"
          placeholder="Hier entsteht Ihr Dokument. Nutzen Sie den Vorlagen-Assistenten, um Textbausteine einzufügen."
        ></textarea>
        <section class="template-history" aria-labelledby="template-history-title">
          <div class="template-history__header">
            <h3 id="template-history-title">Einfügeprotokoll</h3>
            <p id="template-history-summary" class="template-history__summary"></p>
          </div>
          <ul id="template-history-list" class="template-history__list" role="list"></ul>
          <p id="template-history-empty" class="template-history__empty" hidden>
            Noch keine Textbausteine eingefügt. Sobald Sie eine Vorlage übernehmen, erscheint sie hier.
          </p>
        </section>
      </section>

      <section class="role-access-message" data-visible-for="accounting">
        <h2>Vorlagen-Assistent deaktiviert</h2>
        <p>
          Dieser Bereich richtet sich an Mitarbeitende, die Schriftsätze erstellen. Für Buchhaltung
          und Controlling stehen andere Module zur Verfügung. Nutzen Sie den Rollen-Umschalter, um den
          Zugriff zu simulieren.
        </p>
      </section>
    </main>

    <div
      id="global-error-overlay"
      class="error-overlay"
      role="alertdialog"
      aria-modal="true"
      aria-labelledby="error-overlay-title"
      aria-describedby="error-overlay-message"
      hidden
    >
      <div class="error-overlay__content" role="document">
        <header class="error-overlay__header">
          <h2 id="error-overlay-title">Ein unerwarteter Fehler ist aufgetreten</h2>
          <button
            type="button"
            class="error-overlay__close"
            aria-label="Fehlermeldung schließen"
            data-error-action="dismiss"
          >
            ×
          </button>
        </header>
        <div id="error-overlay-message" class="error-overlay__message"></div>
        <details class="error-overlay__details" hidden>
          <summary>Technische Details einblenden</summary>
          <pre id="error-overlay-details"></pre>
        </details>
        <footer class="error-overlay__footer">
          <button type="button" class="btn" data-error-action="reload">Seite neu laden</button>
          <button type="button" class="btn btn-secondary" data-error-action="dismiss">Schließen</button>
        </footer>
      </div>
    </div>

    <script type="application/json" id="template-data">
      [
        {
          "id": "tpl-demand-letter",
          "name": "Zahlungsaufforderung mit Frist",
          "category": "Forderungsmanagement",
          "summary": "Formales Anschreiben an die Gegenseite mit klarer Zahlungsfrist und Ansprechpartner.",
          "tags": ["Mahnung", "Fristsetzung", "Zivilrecht"],
          "placeholders": [
            {
              "id": "recipient",
              "label": "Adressat:in (inkl. Anrede)",
              "type": "text",
              "defaultValue": "Sehr geehrte Frau Schulz"
            },
            {
              "id": "reference",
              "label": "Aktenzeichen/Referenz",
              "type": "text",
              "defaultValue": "V-2024-017"
            },
            {
              "id": "claimAmount",
              "label": "Forderungsbetrag",
              "type": "text",
              "defaultValue": "3.450,00 €"
            },
            {
              "id": "dueDate",
              "label": "Zahlungsfrist",
              "type": "text",
              "defaultValue": "15.11.2025"
            },
            {
              "id": "contact",
              "label": "Kontakt für Rückfragen",
              "type": "text",
              "defaultValue": "RAin Dr. Hannah Keller, Tel. 089 1234 56-0"
            }
          ],
          "body": "{{recipient}},\n\nunter Bezugnahme auf unsere Angelegenheit {{reference}} fordern wir Sie letztmalig auf, den ausstehenden Betrag in Höhe von {{claimAmount}} bis spätestens {{dueDate}} auf das bekannte Kanzleikonto zu überweisen.\n\nSollten Sie Rückfragen haben, wenden Sie sich bitte an {{contact}}.\n\nMit freundlichen Grüßen\nVeriLex Kanzlei-Team"
        },
        {
          "id": "tpl-status-update",
          "name": "Statusbericht an Mandant:in",
          "category": "Mandantenkommunikation",
          "summary": "Kurzer Statusbericht zu offenen Aufgaben und nächsten Schritten.",
          "tags": ["Update", "Mandant", "Transparenz"],
          "placeholders": [
            {
              "id": "clientName",
              "label": "Mandant:in",
              "type": "text",
              "defaultValue": "Müller GmbH"
            },
            {
              "id": "caseTopic",
              "label": "Anliegen/Projekt",
              "type": "text",
              "defaultValue": "Vertragsprüfung Lieferantenrahmenvertrag"
            },
            {
              "id": "currentStatus",
              "label": "Aktueller Status",
              "type": "textarea",
              "defaultValue": "Der Vertragsentwurf wurde überarbeitet und enthält nun die gewünschten Klauseln zur Haftungsbegrenzung."
            },
            {
              "id": "nextSteps",
              "label": "Nächste Schritte",
              "type": "textarea",
              "defaultValue": "Besprechung mit dem Einkaufsteam am 07.11. vorbereiten und Feedback in Fassung 4 einarbeiten."
            },
            {
              "id": "contactPerson",
              "label": "Kontaktperson",
              "type": "text",
              "defaultValue": "RA Felix Sommer"
            }
          ],
          "body": "Sehr geehrte Damen und Herren der {{clientName}},\n\nkurz zum Stand unserer Angelegenheit \"{{caseTopic}}\":\n\nAktueller Status:\n{{currentStatus}}\n\nNächste Schritte:\n{{nextSteps}}\n\nFür Rückfragen steht Ihnen {{contactPerson}} jederzeit gerne zur Verfügung.\n\nMit freundlichen Grüßen\nIhr VeriLex Team"
        },
        {
          "id": "tpl-meeting-minutes",
          "name": "Kurzprotokoll Besprechung",
          "category": "Dokumentation",
          "summary": "Strukturiertes Kurzprotokoll für interne oder externe Abstimmungen.",
          "tags": ["Protokoll", "Besprechung", "Team"],
          "placeholders": [
            {
              "id": "meetingDate",
              "label": "Datum der Besprechung",
              "type": "text",
              "defaultValue": "04.11.2025"
            },
            {
              "id": "participants",
              "label": "Teilnehmende",
              "type": "textarea",
              "defaultValue": "RAin Dr. Hannah Keller, RA Felix Sommer, Mandantin Frau Müller"
            },
            {
              "id": "topics",
              "label": "Besprochene Themen",
              "type": "textarea",
              "defaultValue": "1. Überarbeitung Wettbewerbsverbotsklausel\n2. Zeitplan für Vertragsfinalisierung\n3. Abstimmung Kommunikation Mandantin"
            },
            {
              "id": "decisions",
              "label": "Entscheidungen",
              "type": "textarea",
              "defaultValue": "- Wettbewerbsverbot wird auf 12 Monate begrenzt\n- Finale Fassung bis 12.11. fertigstellen"
            },
            {
              "id": "actionItems",
              "label": "To-dos",
              "type": "textarea",
              "defaultValue": "- Feedback der Mandantin bis 08.11. einarbeiten\n- Abstimmung mit Compliance-Team terminieren"
            }
          ],
          "body": "Kurzprotokoll Besprechung vom {{meetingDate}}\n\nTeilnehmende:\n{{participants}}\n\nThemen:\n{{topics}}\n\nBeschlüsse:\n{{decisions}}\n\nTo-dos:\n{{actionItems}}\n\nBitte um kurze Rückmeldung, falls Ergänzungen erforderlich sind."
        }
      ]
    </script>

    <script src="assets/js/template-assistant.js" type="module"></script>
  </body>
</html>
